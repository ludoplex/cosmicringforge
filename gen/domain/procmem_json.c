/* AUTO-GENERATED by schemagen 2.0.0 â€” DO NOT EDIT */
/* JSON serialization (requires yyjson) */

#include "procmem_json.h"
#include <yyjson.h>
#include <string.h>

int ProcHandle_to_json(const ProcHandle *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_int(doc, root, "pid", obj->pid);
    yyjson_mut_obj_add_uint(doc, root, "handle", obj->handle);
    yyjson_mut_obj_add_uint(doc, root, "flags", obj->flags);
    yyjson_mut_obj_add_int(doc, root, "error_code", obj->error_code);
    yyjson_mut_obj_add_str(doc, root, "error_msg", obj->error_msg);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProcHandle_from_json(const char *json, ProcHandle *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_pid = yyjson_obj_get(root, "pid");
    if (v_pid) obj->pid = yyjson_get_int(v_pid);
    yyjson_val *v_handle = yyjson_obj_get(root, "handle");
    if (v_handle) obj->handle = yyjson_get_uint(v_handle);
    yyjson_val *v_flags = yyjson_obj_get(root, "flags");
    if (v_flags) obj->flags = yyjson_get_uint(v_flags);
    yyjson_val *v_error_code = yyjson_obj_get(root, "error_code");
    if (v_error_code) obj->error_code = yyjson_get_int(v_error_code);
    yyjson_val *v_error_msg = yyjson_obj_get(root, "error_msg");
    if (v_error_msg) strncpy(obj->error_msg, yyjson_get_str(v_error_msg), sizeof(obj->error_msg)-1);

    yyjson_doc_free(doc);
    return 0;
}

int MemRegion_to_json(const MemRegion *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_uint(doc, root, "base", obj->base);
    yyjson_mut_obj_add_uint(doc, root, "size", obj->size);
    yyjson_mut_obj_add_uint(doc, root, "protect", obj->protect);
    yyjson_mut_obj_add_int(doc, root, "type", obj->type);
    yyjson_mut_obj_add_str(doc, root, "name", obj->name);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int MemRegion_from_json(const char *json, MemRegion *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_base = yyjson_obj_get(root, "base");
    if (v_base) obj->base = yyjson_get_uint(v_base);
    yyjson_val *v_size = yyjson_obj_get(root, "size");
    if (v_size) obj->size = yyjson_get_uint(v_size);
    yyjson_val *v_protect = yyjson_obj_get(root, "protect");
    if (v_protect) obj->protect = yyjson_get_uint(v_protect);
    yyjson_val *v_type = yyjson_obj_get(root, "type");
    if (v_type) obj->type = yyjson_get_int(v_type);
    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);

    yyjson_doc_free(doc);
    return 0;
}

int PatchOp_to_json(const PatchOp *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_uint(doc, root, "id", obj->id);
    yyjson_mut_obj_add_uint(doc, root, "address", obj->address);
    yyjson_mut_obj_add_uint(doc, root, "size", obj->size);
    yyjson_mut_obj_add_int(doc, root, "status", obj->status);
    yyjson_mut_obj_add_uint(doc, root, "timestamp", obj->timestamp);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int PatchOp_from_json(const char *json, PatchOp *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_id = yyjson_obj_get(root, "id");
    if (v_id) obj->id = yyjson_get_uint(v_id);
    yyjson_val *v_address = yyjson_obj_get(root, "address");
    if (v_address) obj->address = yyjson_get_uint(v_address);
    yyjson_val *v_size = yyjson_obj_get(root, "size");
    if (v_size) obj->size = yyjson_get_uint(v_size);
    yyjson_val *v_status = yyjson_obj_get(root, "status");
    if (v_status) obj->status = yyjson_get_int(v_status);
    yyjson_val *v_timestamp = yyjson_obj_get(root, "timestamp");
    if (v_timestamp) obj->timestamp = yyjson_get_uint(v_timestamp);

    yyjson_doc_free(doc);
    return 0;
}

int PlatformInfo_to_json(const PlatformInfo *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_int(doc, root, "os", obj->os);
    yyjson_mut_obj_add_int(doc, root, "arch", obj->arch);
    yyjson_mut_obj_add_uint(doc, root, "page_size", obj->page_size);
    yyjson_mut_obj_add_int(doc, root, "can_remote", obj->can_remote);
    yyjson_mut_obj_add_int(doc, root, "can_self", obj->can_self);
    yyjson_mut_obj_add_str(doc, root, "backend", obj->backend);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int PlatformInfo_from_json(const char *json, PlatformInfo *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_os = yyjson_obj_get(root, "os");
    if (v_os) obj->os = yyjson_get_int(v_os);
    yyjson_val *v_arch = yyjson_obj_get(root, "arch");
    if (v_arch) obj->arch = yyjson_get_int(v_arch);
    yyjson_val *v_page_size = yyjson_obj_get(root, "page_size");
    if (v_page_size) obj->page_size = yyjson_get_uint(v_page_size);
    yyjson_val *v_can_remote = yyjson_obj_get(root, "can_remote");
    if (v_can_remote) obj->can_remote = yyjson_get_int(v_can_remote);
    yyjson_val *v_can_self = yyjson_obj_get(root, "can_self");
    if (v_can_self) obj->can_self = yyjson_get_int(v_can_self);
    yyjson_val *v_backend = yyjson_obj_get(root, "backend");
    if (v_backend) strncpy(obj->backend, yyjson_get_str(v_backend), sizeof(obj->backend)-1);

    yyjson_doc_free(doc);
    return 0;
}

