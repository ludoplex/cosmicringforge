/* AUTO-GENERATED by schemagen 2.0.0 â€” DO NOT EDIT */
/* JSON serialization (requires yyjson) */

#include "impl_json.h"
#include <yyjson.h>
#include <string.h>

int ImplPlatformTarget_to_json(const ImplPlatformTarget *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "platform", obj->platform);
    yyjson_mut_obj_add_str(doc, root, "source_file", obj->source_file);
    yyjson_mut_obj_add_int(doc, root, "enabled", obj->enabled);
    yyjson_mut_obj_add_int(doc, root, "priority", obj->priority);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplPlatformTarget_from_json(const char *json, ImplPlatformTarget *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_platform = yyjson_obj_get(root, "platform");
    if (v_platform) strncpy(obj->platform, yyjson_get_str(v_platform), sizeof(obj->platform)-1);
    yyjson_val *v_source_file = yyjson_obj_get(root, "source_file");
    if (v_source_file) strncpy(obj->source_file, yyjson_get_str(v_source_file), sizeof(obj->source_file)-1);
    yyjson_val *v_enabled = yyjson_obj_get(root, "enabled");
    if (v_enabled) obj->enabled = yyjson_get_int(v_enabled);
    yyjson_val *v_priority = yyjson_obj_get(root, "priority");
    if (v_priority) obj->priority = yyjson_get_int(v_priority);

    yyjson_doc_free(doc);
    return 0;
}

int ImplPlatform_to_json(const ImplPlatform *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_int(doc, root, "target_count", obj->target_count);
    yyjson_mut_obj_add_str(doc, root, "fallback_file", obj->fallback_file);
    yyjson_mut_obj_add_int(doc, root, "dispatch_style", obj->dispatch_style);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplPlatform_from_json(const char *json, ImplPlatform *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_target_count = yyjson_obj_get(root, "target_count");
    if (v_target_count) obj->target_count = yyjson_get_int(v_target_count);
    yyjson_val *v_fallback_file = yyjson_obj_get(root, "fallback_file");
    if (v_fallback_file) strncpy(obj->fallback_file, yyjson_get_str(v_fallback_file), sizeof(obj->fallback_file)-1);
    yyjson_val *v_dispatch_style = yyjson_obj_get(root, "dispatch_style");
    if (v_dispatch_style) obj->dispatch_style = yyjson_get_int(v_dispatch_style);

    yyjson_doc_free(doc);
    return 0;
}

int ImplOptimizeFunc_to_json(const ImplOptimizeFunc *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_int(doc, root, "force_inline", obj->force_inline);
    yyjson_mut_obj_add_int(doc, root, "no_inline", obj->no_inline);
    yyjson_mut_obj_add_int(doc, root, "hot", obj->hot);
    yyjson_mut_obj_add_int(doc, root, "cold", obj->cold);
    yyjson_mut_obj_add_int(doc, root, "pure", obj->pure);
    yyjson_mut_obj_add_int(doc, root, "const_func", obj->const_func);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplOptimizeFunc_from_json(const char *json, ImplOptimizeFunc *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_force_inline = yyjson_obj_get(root, "force_inline");
    if (v_force_inline) obj->force_inline = yyjson_get_int(v_force_inline);
    yyjson_val *v_no_inline = yyjson_obj_get(root, "no_inline");
    if (v_no_inline) obj->no_inline = yyjson_get_int(v_no_inline);
    yyjson_val *v_hot = yyjson_obj_get(root, "hot");
    if (v_hot) obj->hot = yyjson_get_int(v_hot);
    yyjson_val *v_cold = yyjson_obj_get(root, "cold");
    if (v_cold) obj->cold = yyjson_get_int(v_cold);
    yyjson_val *v_pure = yyjson_obj_get(root, "pure");
    if (v_pure) obj->pure = yyjson_get_int(v_pure);
    yyjson_val *v_const_func = yyjson_obj_get(root, "const_func");
    if (v_const_func) obj->const_func = yyjson_get_int(v_const_func);

    yyjson_doc_free(doc);
    return 0;
}

int ImplOptimizeType_to_json(const ImplOptimizeType *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_int(doc, root, "alignment", obj->alignment);
    yyjson_mut_obj_add_int(doc, root, "pack", obj->pack);
    yyjson_mut_obj_add_int(doc, root, "cache_align", obj->cache_align);
    yyjson_mut_obj_add_str(doc, root, "inline_funcs", obj->inline_funcs);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplOptimizeType_from_json(const char *json, ImplOptimizeType *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_alignment = yyjson_obj_get(root, "alignment");
    if (v_alignment) obj->alignment = yyjson_get_int(v_alignment);
    yyjson_val *v_pack = yyjson_obj_get(root, "pack");
    if (v_pack) obj->pack = yyjson_get_int(v_pack);
    yyjson_val *v_cache_align = yyjson_obj_get(root, "cache_align");
    if (v_cache_align) obj->cache_align = yyjson_get_int(v_cache_align);
    yyjson_val *v_inline_funcs = yyjson_obj_get(root, "inline_funcs");
    if (v_inline_funcs) strncpy(obj->inline_funcs, yyjson_get_str(v_inline_funcs), sizeof(obj->inline_funcs)-1);

    yyjson_doc_free(doc);
    return 0;
}

int ImplOptimize_to_json(const ImplOptimize *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_int(doc, root, "func_count", obj->func_count);
    yyjson_mut_obj_add_int(doc, root, "type_count", obj->type_count);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplOptimize_from_json(const char *json, ImplOptimize *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_func_count = yyjson_obj_get(root, "func_count");
    if (v_func_count) obj->func_count = yyjson_get_int(v_func_count);
    yyjson_val *v_type_count = yyjson_obj_get(root, "type_count");
    if (v_type_count) obj->type_count = yyjson_get_int(v_type_count);

    yyjson_doc_free(doc);
    return 0;
}

int ImplSimdTarget_to_json(const ImplSimdTarget *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_int(doc, root, "enabled", obj->enabled);
    yyjson_mut_obj_add_int(doc, root, "priority", obj->priority);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplSimdTarget_from_json(const char *json, ImplSimdTarget *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_enabled = yyjson_obj_get(root, "enabled");
    if (v_enabled) obj->enabled = yyjson_get_int(v_enabled);
    yyjson_val *v_priority = yyjson_obj_get(root, "priority");
    if (v_priority) obj->priority = yyjson_get_int(v_priority);

    yyjson_doc_free(doc);
    return 0;
}

int ImplSimd_to_json(const ImplSimd *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_int(doc, root, "target_count", obj->target_count);
    yyjson_mut_obj_add_str(doc, root, "fallback", obj->fallback);
    yyjson_mut_obj_add_int(doc, root, "runtime_detect", obj->runtime_detect);
    yyjson_mut_obj_add_int(doc, root, "compile_all", obj->compile_all);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplSimd_from_json(const char *json, ImplSimd *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_target_count = yyjson_obj_get(root, "target_count");
    if (v_target_count) obj->target_count = yyjson_get_int(v_target_count);
    yyjson_val *v_fallback = yyjson_obj_get(root, "fallback");
    if (v_fallback) strncpy(obj->fallback, yyjson_get_str(v_fallback), sizeof(obj->fallback)-1);
    yyjson_val *v_runtime_detect = yyjson_obj_get(root, "runtime_detect");
    if (v_runtime_detect) obj->runtime_detect = yyjson_get_int(v_runtime_detect);
    yyjson_val *v_compile_all = yyjson_obj_get(root, "compile_all");
    if (v_compile_all) obj->compile_all = yyjson_get_int(v_compile_all);

    yyjson_doc_free(doc);
    return 0;
}

int ImplAllocArena_to_json(const ImplAllocArena *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_int(doc, root, "initial_size", obj->initial_size);
    yyjson_mut_obj_add_int(doc, root, "max_size", obj->max_size);
    yyjson_mut_obj_add_int(doc, root, "alignment", obj->alignment);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplAllocArena_from_json(const char *json, ImplAllocArena *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_initial_size = yyjson_obj_get(root, "initial_size");
    if (v_initial_size) obj->initial_size = yyjson_get_int(v_initial_size);
    yyjson_val *v_max_size = yyjson_obj_get(root, "max_size");
    if (v_max_size) obj->max_size = yyjson_get_int(v_max_size);
    yyjson_val *v_alignment = yyjson_obj_get(root, "alignment");
    if (v_alignment) obj->alignment = yyjson_get_int(v_alignment);

    yyjson_doc_free(doc);
    return 0;
}

int ImplAllocPool_to_json(const ImplAllocPool *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_str(doc, root, "element_type", obj->element_type);
    yyjson_mut_obj_add_int(doc, root, "initial_count", obj->initial_count);
    yyjson_mut_obj_add_int(doc, root, "max_count", obj->max_count);
    yyjson_mut_obj_add_int(doc, root, "thread_local", obj->thread_local);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplAllocPool_from_json(const char *json, ImplAllocPool *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_element_type = yyjson_obj_get(root, "element_type");
    if (v_element_type) strncpy(obj->element_type, yyjson_get_str(v_element_type), sizeof(obj->element_type)-1);
    yyjson_val *v_initial_count = yyjson_obj_get(root, "initial_count");
    if (v_initial_count) obj->initial_count = yyjson_get_int(v_initial_count);
    yyjson_val *v_max_count = yyjson_obj_get(root, "max_count");
    if (v_max_count) obj->max_count = yyjson_get_int(v_max_count);
    yyjson_val *v_thread_local = yyjson_obj_get(root, "thread_local");
    if (v_thread_local) obj->thread_local = yyjson_get_int(v_thread_local);

    yyjson_doc_free(doc);
    return 0;
}

int ImplAlloc_to_json(const ImplAlloc *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_int(doc, root, "arena_count", obj->arena_count);
    yyjson_mut_obj_add_int(doc, root, "pool_count", obj->pool_count);
    yyjson_mut_obj_add_str(doc, root, "default_allocator", obj->default_allocator);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplAlloc_from_json(const char *json, ImplAlloc *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_arena_count = yyjson_obj_get(root, "arena_count");
    if (v_arena_count) obj->arena_count = yyjson_get_int(v_arena_count);
    yyjson_val *v_pool_count = yyjson_obj_get(root, "pool_count");
    if (v_pool_count) obj->pool_count = yyjson_get_int(v_pool_count);
    yyjson_val *v_default_allocator = yyjson_obj_get(root, "default_allocator");
    if (v_default_allocator) strncpy(obj->default_allocator, yyjson_get_str(v_default_allocator), sizeof(obj->default_allocator)-1);

    yyjson_doc_free(doc);
    return 0;
}

int ImplError_to_json(const ImplError *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_int(doc, root, "strategy", obj->strategy);
    yyjson_mut_obj_add_str(doc, root, "error_type", obj->error_type);
    yyjson_mut_obj_add_int(doc, root, "generate_strerror", obj->generate_strerror);
    yyjson_mut_obj_add_int(doc, root, "log_on_error", obj->log_on_error);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplError_from_json(const char *json, ImplError *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_strategy = yyjson_obj_get(root, "strategy");
    if (v_strategy) obj->strategy = yyjson_get_int(v_strategy);
    yyjson_val *v_error_type = yyjson_obj_get(root, "error_type");
    if (v_error_type) strncpy(obj->error_type, yyjson_get_str(v_error_type), sizeof(obj->error_type)-1);
    yyjson_val *v_generate_strerror = yyjson_obj_get(root, "generate_strerror");
    if (v_generate_strerror) obj->generate_strerror = yyjson_get_int(v_generate_strerror);
    yyjson_val *v_log_on_error = yyjson_obj_get(root, "log_on_error");
    if (v_log_on_error) obj->log_on_error = yyjson_get_int(v_log_on_error);

    yyjson_doc_free(doc);
    return 0;
}

int ImplParseState_to_json(const ImplParseState *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_int(doc, root, "platform_count", obj->platform_count);
    yyjson_mut_obj_add_int(doc, root, "optimize_count", obj->optimize_count);
    yyjson_mut_obj_add_int(doc, root, "simd_count", obj->simd_count);
    yyjson_mut_obj_add_int(doc, root, "alloc_count", obj->alloc_count);
    yyjson_mut_obj_add_int(doc, root, "current_line", obj->current_line);
    yyjson_mut_obj_add_int(doc, root, "error_code", obj->error_code);
    yyjson_mut_obj_add_str(doc, root, "error_msg", obj->error_msg);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplParseState_from_json(const char *json, ImplParseState *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_platform_count = yyjson_obj_get(root, "platform_count");
    if (v_platform_count) obj->platform_count = yyjson_get_int(v_platform_count);
    yyjson_val *v_optimize_count = yyjson_obj_get(root, "optimize_count");
    if (v_optimize_count) obj->optimize_count = yyjson_get_int(v_optimize_count);
    yyjson_val *v_simd_count = yyjson_obj_get(root, "simd_count");
    if (v_simd_count) obj->simd_count = yyjson_get_int(v_simd_count);
    yyjson_val *v_alloc_count = yyjson_obj_get(root, "alloc_count");
    if (v_alloc_count) obj->alloc_count = yyjson_get_int(v_alloc_count);
    yyjson_val *v_current_line = yyjson_obj_get(root, "current_line");
    if (v_current_line) obj->current_line = yyjson_get_int(v_current_line);
    yyjson_val *v_error_code = yyjson_obj_get(root, "error_code");
    if (v_error_code) obj->error_code = yyjson_get_int(v_error_code);
    yyjson_val *v_error_msg = yyjson_obj_get(root, "error_msg");
    if (v_error_msg) strncpy(obj->error_msg, yyjson_get_str(v_error_msg), sizeof(obj->error_msg)-1);

    yyjson_doc_free(doc);
    return 0;
}

int ImplGenConfig_to_json(const ImplGenConfig *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "input_path", obj->input_path);
    yyjson_mut_obj_add_str(doc, root, "output_dir", obj->output_dir);
    yyjson_mut_obj_add_str(doc, root, "target_platform", obj->target_platform);
    yyjson_mut_obj_add_str(doc, root, "target_simd", obj->target_simd);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ImplGenConfig_from_json(const char *json, ImplGenConfig *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_input_path = yyjson_obj_get(root, "input_path");
    if (v_input_path) strncpy(obj->input_path, yyjson_get_str(v_input_path), sizeof(obj->input_path)-1);
    yyjson_val *v_output_dir = yyjson_obj_get(root, "output_dir");
    if (v_output_dir) strncpy(obj->output_dir, yyjson_get_str(v_output_dir), sizeof(obj->output_dir)-1);
    yyjson_val *v_target_platform = yyjson_obj_get(root, "target_platform");
    if (v_target_platform) strncpy(obj->target_platform, yyjson_get_str(v_target_platform), sizeof(obj->target_platform)-1);
    yyjson_val *v_target_simd = yyjson_obj_get(root, "target_simd");
    if (v_target_simd) strncpy(obj->target_simd, yyjson_get_str(v_target_simd), sizeof(obj->target_simd)-1);

    yyjson_doc_free(doc);
    return 0;
}

