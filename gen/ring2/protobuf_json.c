/* AUTO-GENERATED by schemagen 2.0.0 â€” DO NOT EDIT */
/* JSON serialization (requires yyjson) */

#include "protobuf_json.h"
#include <yyjson.h>
#include <string.h>

int ProtoField_to_json(const ProtoField *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_int(doc, root, "field_number", obj->field_number);
    yyjson_mut_obj_add_uint(doc, root, "field_type", obj->field_type);
    yyjson_mut_obj_add_str(doc, root, "type_name", obj->type_name);
    yyjson_mut_obj_add_uint(doc, root, "label", obj->label);
    yyjson_mut_obj_add_str(doc, root, "default_value", obj->default_value);
    yyjson_mut_obj_add_int(doc, root, "oneof_index", obj->oneof_index);
    yyjson_mut_obj_add_int(doc, root, "packed", obj->packed);
    yyjson_mut_obj_add_int(doc, root, "deprecated", obj->deprecated);
    yyjson_mut_obj_add_str(doc, root, "json_name", obj->json_name);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoField_from_json(const char *json, ProtoField *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_field_number = yyjson_obj_get(root, "field_number");
    if (v_field_number) obj->field_number = yyjson_get_int(v_field_number);
    yyjson_val *v_field_type = yyjson_obj_get(root, "field_type");
    if (v_field_type) obj->field_type = yyjson_get_uint(v_field_type);
    yyjson_val *v_type_name = yyjson_obj_get(root, "type_name");
    if (v_type_name) strncpy(obj->type_name, yyjson_get_str(v_type_name), sizeof(obj->type_name)-1);
    yyjson_val *v_label = yyjson_obj_get(root, "label");
    if (v_label) obj->label = yyjson_get_uint(v_label);
    yyjson_val *v_default_value = yyjson_obj_get(root, "default_value");
    if (v_default_value) strncpy(obj->default_value, yyjson_get_str(v_default_value), sizeof(obj->default_value)-1);
    yyjson_val *v_oneof_index = yyjson_obj_get(root, "oneof_index");
    if (v_oneof_index) obj->oneof_index = yyjson_get_int(v_oneof_index);
    yyjson_val *v_packed = yyjson_obj_get(root, "packed");
    if (v_packed) obj->packed = yyjson_get_int(v_packed);
    yyjson_val *v_deprecated = yyjson_obj_get(root, "deprecated");
    if (v_deprecated) obj->deprecated = yyjson_get_int(v_deprecated);
    yyjson_val *v_json_name = yyjson_obj_get(root, "json_name");
    if (v_json_name) strncpy(obj->json_name, yyjson_get_str(v_json_name), sizeof(obj->json_name)-1);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoMessage_to_json(const ProtoMessage *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_str(doc, root, "full_name", obj->full_name);
    yyjson_mut_obj_add_int(doc, root, "field_count", obj->field_count);
    yyjson_mut_obj_add_int(doc, root, "nested_type_count", obj->nested_type_count);
    yyjson_mut_obj_add_int(doc, root, "enum_type_count", obj->enum_type_count);
    yyjson_mut_obj_add_int(doc, root, "oneof_count", obj->oneof_count);
    yyjson_mut_obj_add_str(doc, root, "reserved_ranges", obj->reserved_ranges);
    yyjson_mut_obj_add_str(doc, root, "reserved_names", obj->reserved_names);
    yyjson_mut_obj_add_int(doc, root, "deprecated", obj->deprecated);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoMessage_from_json(const char *json, ProtoMessage *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_full_name = yyjson_obj_get(root, "full_name");
    if (v_full_name) strncpy(obj->full_name, yyjson_get_str(v_full_name), sizeof(obj->full_name)-1);
    yyjson_val *v_field_count = yyjson_obj_get(root, "field_count");
    if (v_field_count) obj->field_count = yyjson_get_int(v_field_count);
    yyjson_val *v_nested_type_count = yyjson_obj_get(root, "nested_type_count");
    if (v_nested_type_count) obj->nested_type_count = yyjson_get_int(v_nested_type_count);
    yyjson_val *v_enum_type_count = yyjson_obj_get(root, "enum_type_count");
    if (v_enum_type_count) obj->enum_type_count = yyjson_get_int(v_enum_type_count);
    yyjson_val *v_oneof_count = yyjson_obj_get(root, "oneof_count");
    if (v_oneof_count) obj->oneof_count = yyjson_get_int(v_oneof_count);
    yyjson_val *v_reserved_ranges = yyjson_obj_get(root, "reserved_ranges");
    if (v_reserved_ranges) strncpy(obj->reserved_ranges, yyjson_get_str(v_reserved_ranges), sizeof(obj->reserved_ranges)-1);
    yyjson_val *v_reserved_names = yyjson_obj_get(root, "reserved_names");
    if (v_reserved_names) strncpy(obj->reserved_names, yyjson_get_str(v_reserved_names), sizeof(obj->reserved_names)-1);
    yyjson_val *v_deprecated = yyjson_obj_get(root, "deprecated");
    if (v_deprecated) obj->deprecated = yyjson_get_int(v_deprecated);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoEnum_to_json(const ProtoEnum *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_str(doc, root, "full_name", obj->full_name);
    yyjson_mut_obj_add_int(doc, root, "value_count", obj->value_count);
    yyjson_mut_obj_add_int(doc, root, "allow_alias", obj->allow_alias);
    yyjson_mut_obj_add_int(doc, root, "deprecated", obj->deprecated);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoEnum_from_json(const char *json, ProtoEnum *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_full_name = yyjson_obj_get(root, "full_name");
    if (v_full_name) strncpy(obj->full_name, yyjson_get_str(v_full_name), sizeof(obj->full_name)-1);
    yyjson_val *v_value_count = yyjson_obj_get(root, "value_count");
    if (v_value_count) obj->value_count = yyjson_get_int(v_value_count);
    yyjson_val *v_allow_alias = yyjson_obj_get(root, "allow_alias");
    if (v_allow_alias) obj->allow_alias = yyjson_get_int(v_allow_alias);
    yyjson_val *v_deprecated = yyjson_obj_get(root, "deprecated");
    if (v_deprecated) obj->deprecated = yyjson_get_int(v_deprecated);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoEnumValue_to_json(const ProtoEnumValue *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_int(doc, root, "number", obj->number);
    yyjson_mut_obj_add_int(doc, root, "deprecated", obj->deprecated);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoEnumValue_from_json(const char *json, ProtoEnumValue *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_number = yyjson_obj_get(root, "number");
    if (v_number) obj->number = yyjson_get_int(v_number);
    yyjson_val *v_deprecated = yyjson_obj_get(root, "deprecated");
    if (v_deprecated) obj->deprecated = yyjson_get_int(v_deprecated);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoOneof_to_json(const ProtoOneof *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_int(doc, root, "field_count", obj->field_count);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoOneof_from_json(const char *json, ProtoOneof *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_field_count = yyjson_obj_get(root, "field_count");
    if (v_field_count) obj->field_count = yyjson_get_int(v_field_count);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoService_to_json(const ProtoService *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_str(doc, root, "full_name", obj->full_name);
    yyjson_mut_obj_add_int(doc, root, "method_count", obj->method_count);
    yyjson_mut_obj_add_int(doc, root, "deprecated", obj->deprecated);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoService_from_json(const char *json, ProtoService *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_full_name = yyjson_obj_get(root, "full_name");
    if (v_full_name) strncpy(obj->full_name, yyjson_get_str(v_full_name), sizeof(obj->full_name)-1);
    yyjson_val *v_method_count = yyjson_obj_get(root, "method_count");
    if (v_method_count) obj->method_count = yyjson_get_int(v_method_count);
    yyjson_val *v_deprecated = yyjson_obj_get(root, "deprecated");
    if (v_deprecated) obj->deprecated = yyjson_get_int(v_deprecated);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoMethod_to_json(const ProtoMethod *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_str(doc, root, "input_type", obj->input_type);
    yyjson_mut_obj_add_str(doc, root, "output_type", obj->output_type);
    yyjson_mut_obj_add_int(doc, root, "client_streaming", obj->client_streaming);
    yyjson_mut_obj_add_int(doc, root, "server_streaming", obj->server_streaming);
    yyjson_mut_obj_add_int(doc, root, "deprecated", obj->deprecated);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoMethod_from_json(const char *json, ProtoMethod *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_input_type = yyjson_obj_get(root, "input_type");
    if (v_input_type) strncpy(obj->input_type, yyjson_get_str(v_input_type), sizeof(obj->input_type)-1);
    yyjson_val *v_output_type = yyjson_obj_get(root, "output_type");
    if (v_output_type) strncpy(obj->output_type, yyjson_get_str(v_output_type), sizeof(obj->output_type)-1);
    yyjson_val *v_client_streaming = yyjson_obj_get(root, "client_streaming");
    if (v_client_streaming) obj->client_streaming = yyjson_get_int(v_client_streaming);
    yyjson_val *v_server_streaming = yyjson_obj_get(root, "server_streaming");
    if (v_server_streaming) obj->server_streaming = yyjson_get_int(v_server_streaming);
    yyjson_val *v_deprecated = yyjson_obj_get(root, "deprecated");
    if (v_deprecated) obj->deprecated = yyjson_get_int(v_deprecated);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoFile_to_json(const ProtoFile *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "name", obj->name);
    yyjson_mut_obj_add_str(doc, root, "package", obj->package);
    yyjson_mut_obj_add_str(doc, root, "syntax", obj->syntax);
    yyjson_mut_obj_add_int(doc, root, "message_count", obj->message_count);
    yyjson_mut_obj_add_int(doc, root, "enum_count", obj->enum_count);
    yyjson_mut_obj_add_int(doc, root, "service_count", obj->service_count);
    yyjson_mut_obj_add_int(doc, root, "dependency_count", obj->dependency_count);
    yyjson_mut_obj_add_int(doc, root, "public_dependency_count", obj->public_dependency_count);
    yyjson_mut_obj_add_int(doc, root, "weak_dependency_count", obj->weak_dependency_count);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoFile_from_json(const char *json, ProtoFile *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_name = yyjson_obj_get(root, "name");
    if (v_name) strncpy(obj->name, yyjson_get_str(v_name), sizeof(obj->name)-1);
    yyjson_val *v_package = yyjson_obj_get(root, "package");
    if (v_package) strncpy(obj->package, yyjson_get_str(v_package), sizeof(obj->package)-1);
    yyjson_val *v_syntax = yyjson_obj_get(root, "syntax");
    if (v_syntax) strncpy(obj->syntax, yyjson_get_str(v_syntax), sizeof(obj->syntax)-1);
    yyjson_val *v_message_count = yyjson_obj_get(root, "message_count");
    if (v_message_count) obj->message_count = yyjson_get_int(v_message_count);
    yyjson_val *v_enum_count = yyjson_obj_get(root, "enum_count");
    if (v_enum_count) obj->enum_count = yyjson_get_int(v_enum_count);
    yyjson_val *v_service_count = yyjson_obj_get(root, "service_count");
    if (v_service_count) obj->service_count = yyjson_get_int(v_service_count);
    yyjson_val *v_dependency_count = yyjson_obj_get(root, "dependency_count");
    if (v_dependency_count) obj->dependency_count = yyjson_get_int(v_dependency_count);
    yyjson_val *v_public_dependency_count = yyjson_obj_get(root, "public_dependency_count");
    if (v_public_dependency_count) obj->public_dependency_count = yyjson_get_int(v_public_dependency_count);
    yyjson_val *v_weak_dependency_count = yyjson_obj_get(root, "weak_dependency_count");
    if (v_weak_dependency_count) obj->weak_dependency_count = yyjson_get_int(v_weak_dependency_count);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoImport_to_json(const ProtoImport *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "file_path", obj->file_path);
    yyjson_mut_obj_add_int(doc, root, "is_public", obj->is_public);
    yyjson_mut_obj_add_int(doc, root, "is_weak", obj->is_weak);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoImport_from_json(const char *json, ProtoImport *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_file_path = yyjson_obj_get(root, "file_path");
    if (v_file_path) strncpy(obj->file_path, yyjson_get_str(v_file_path), sizeof(obj->file_path)-1);
    yyjson_val *v_is_public = yyjson_obj_get(root, "is_public");
    if (v_is_public) obj->is_public = yyjson_get_int(v_is_public);
    yyjson_val *v_is_weak = yyjson_obj_get(root, "is_weak");
    if (v_is_weak) obj->is_weak = yyjson_get_int(v_is_weak);

    yyjson_doc_free(doc);
    return 0;
}

int ProtocCConfig_to_json(const ProtocCConfig *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_str(doc, root, "input_path", obj->input_path);
    yyjson_mut_obj_add_str(doc, root, "output_dir", obj->output_dir);
    yyjson_mut_obj_add_str(doc, root, "include_paths", obj->include_paths);
    yyjson_mut_obj_add_int(doc, root, "generate_rpc", obj->generate_rpc);
    yyjson_mut_obj_add_int(doc, root, "generate_pack", obj->generate_pack);
    yyjson_mut_obj_add_int(doc, root, "generate_init", obj->generate_init);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtocCConfig_from_json(const char *json, ProtocCConfig *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_input_path = yyjson_obj_get(root, "input_path");
    if (v_input_path) strncpy(obj->input_path, yyjson_get_str(v_input_path), sizeof(obj->input_path)-1);
    yyjson_val *v_output_dir = yyjson_obj_get(root, "output_dir");
    if (v_output_dir) strncpy(obj->output_dir, yyjson_get_str(v_output_dir), sizeof(obj->output_dir)-1);
    yyjson_val *v_include_paths = yyjson_obj_get(root, "include_paths");
    if (v_include_paths) strncpy(obj->include_paths, yyjson_get_str(v_include_paths), sizeof(obj->include_paths)-1);
    yyjson_val *v_generate_rpc = yyjson_obj_get(root, "generate_rpc");
    if (v_generate_rpc) obj->generate_rpc = yyjson_get_int(v_generate_rpc);
    yyjson_val *v_generate_pack = yyjson_obj_get(root, "generate_pack");
    if (v_generate_pack) obj->generate_pack = yyjson_get_int(v_generate_pack);
    yyjson_val *v_generate_init = yyjson_obj_get(root, "generate_init");
    if (v_generate_init) obj->generate_init = yyjson_get_int(v_generate_init);

    yyjson_doc_free(doc);
    return 0;
}

int ProtoParseState_to_json(const ProtoParseState *obj, char *buf, size_t size) {
    yyjson_mut_doc *doc = yyjson_mut_doc_new(NULL);
    yyjson_mut_val *root = yyjson_mut_obj(doc);
    yyjson_mut_doc_set_root(doc, root);

    yyjson_mut_obj_add_int(doc, root, "file_count", obj->file_count);
    yyjson_mut_obj_add_int(doc, root, "message_count", obj->message_count);
    yyjson_mut_obj_add_int(doc, root, "enum_count", obj->enum_count);
    yyjson_mut_obj_add_int(doc, root, "service_count", obj->service_count);
    yyjson_mut_obj_add_int(doc, root, "error_code", obj->error_code);
    yyjson_mut_obj_add_str(doc, root, "error_msg", obj->error_msg);

    size_t len = 0;
    char *json_str = yyjson_mut_write(doc, 0, &len);
    yyjson_mut_doc_free(doc);
    if (!json_str) return -1;
    if (len >= size) { free(json_str); return -1; }
    memcpy(buf, json_str, len + 1);
    free(json_str);
    return (int)len;
}

int ProtoParseState_from_json(const char *json, ProtoParseState *obj) {
    yyjson_doc *doc = yyjson_read(json, strlen(json), 0);
    if (!doc) return -1;
    yyjson_val *root = yyjson_doc_get_root(doc);

    yyjson_val *v_file_count = yyjson_obj_get(root, "file_count");
    if (v_file_count) obj->file_count = yyjson_get_int(v_file_count);
    yyjson_val *v_message_count = yyjson_obj_get(root, "message_count");
    if (v_message_count) obj->message_count = yyjson_get_int(v_message_count);
    yyjson_val *v_enum_count = yyjson_obj_get(root, "enum_count");
    if (v_enum_count) obj->enum_count = yyjson_get_int(v_enum_count);
    yyjson_val *v_service_count = yyjson_obj_get(root, "service_count");
    if (v_service_count) obj->service_count = yyjson_get_int(v_service_count);
    yyjson_val *v_error_code = yyjson_obj_get(root, "error_code");
    if (v_error_code) obj->error_code = yyjson_get_int(v_error_code);
    yyjson_val *v_error_msg = yyjson_obj_get(root, "error_msg");
    if (v_error_msg) strncpy(obj->error_msg, yyjson_get_str(v_error_msg), sizeof(obj->error_msg)-1);

    yyjson_doc_free(doc);
    return 0;
}

